Todo o readme abaixo foi estilizado e melhorado com ajuda de IA.
# API de Gerenciamento de Carteira (hanielapi)

![Java](https://img.shields.io/badge/Java-21-blue.svg?style=for-the-badge&logo=java)
![Spring Boot](https://img.shields.io/badge/Spring%20Boot-3.5.6-brightgreen.svg?style=for-the-badge&logo=spring)
![JPA/Hibernate](https://img.shields.io/badge/JPA-Hibernate-blueviolet.svg?style=for-the-badge)
![Database](https://img.shields.io/badge/Database-H2%20In--Memory-red.svg?style=for-the-badge)

Este projeto √© uma API RESTful robusta desenvolvida em Spring Boot, como projeto final para a disciplina de **Arquitetura Java** do **Instituto Infnet**.

A aplica√ß√£o simula um sistema de back-end para o gerenciamento de uma carteira de investimentos pessoal, permitindo o cadastro, consulta, altera√ß√£o e exclus√£o de diferentes tipos de ativos financeiros, suas empresas emissoras e seus proventos.

## üìñ Sobre o Projeto

O objetivo central √© aplicar conceitos avan√ßados de arquitetura de software para construir um servi√ßo resiliente e bem-estruturado. O projeto foi dividido em 4 "features" que evolu√≠ram a aplica√ß√£o:

* **Feature 1:** Configura√ß√£o inicial do Spring Boot e arquitetura de camadas (Controller, Service) com persist√™ncia em mem√≥ria.
* **Feature 2:** Implementa√ß√£o de Heran√ßa (`Ativo`, `Acao`, `FII`), servi√ßos dedicados por entidade e exce√ß√µes customizadas.
* **Feature 3:** Migra√ß√£o da persist√™ncia de `Map` em mem√≥ria para **Spring Data JPA** com um banco **H2**. Mapeamento de entidades (`@Entity`), relacionamentos (`@ManyToOne`) e refinamento da API com `ResponseEntity`.
* **Feature 4:** "Blindagem" da API com **Bean Validation** (`@Valid`), tratamento global de exce√ß√µes (`@ControllerAdvice`), implementa√ß√£o de relacionamentos `One-to-Many` (`Acao` -> `Provento`) e uso de *Query Methods* complexos.

## üèõÔ∏è Modelo do Dom√≠nio (Entidades)

A persist√™ncia dos dados √© gerenciada pelo JPA e segue o seguinte modelo relacional:

* **`Ativo` (`@MappedSuperclass`)**: Classe-m√£e abstrata que define os campos comuns como `id`, `nome`, `quantidade` e `precoMedio`. O ID √© gerado pelo banco (`@GeneratedValue`).
* **`Acao` (`@Entity`)**: Entidade que herda de `Ativo`.
    * Possui um relacionamento **`@ManyToOne`** com a `Empresa` (uma a√ß√£o est√° ligada a uma empresa).
    * Possui um relacionamento **`@OneToMany`** com `Provento` (uma a√ß√£o pode ter muitos proventos).
* **`FundoImobiliario` (`@Entity`)**: Entidade que herda de `Ativo`.
* **`Empresa` (`@Entity`)**: Entidade que armazena os dados da empresa emissora (nome, setor, CNPJ).
* **`Provento` (`@Entity`)**: Entidade que armazena dividendos/JCP e possui um relacionamento **`@ManyToOne`** com `Acao`.

## üíª Stack de Tecnologias

* **Java 21**
* **Spring Boot 3.5.6**
* **Spring Web:** Para a cria√ß√£o dos controllers REST.
* **Spring Data JPA:** Para a camada de persist√™ncia de dados.
* **Hibernate:** Implementa√ß√£o do JPA para mapeamento Objeto-Relacional (ORM).
* **H2 Database:** Banco de dados relacional em mem√≥ria para desenvolvimento.
* **Spring Boot Validation:** Para valida√ß√£o declarativa dos DTOs e entidades.
* **Lombok:** Para reduzir o c√≥digo boilerplate (getters, setters, construtores).
* **Maven:** Para gerenciamento de depend√™ncias e build do projeto.

## üöÄ Como Executar

### Pr√©-requisitos

* JDK 21 ou superior
* Maven 3.x

### Rodando a Aplica√ß√£o

1.  Clone este reposit√≥rio:
    ```bash
    git clone [https://github.com/seu-usuario/hanielapi.git](https://github.com/seu-usuario/hanielapi.git)
    cd hanielapi
    ```
2.  Execute a aplica√ß√£o usando o Maven Wrapper:
    * No Linux/macOS:
        ```bash
        ./mvnw spring-boot:run
        ```
    * No Windows:
        ```bash
        mvnw.cmd spring-boot:run
        ```
3.  A API estar√° dispon√≠vel em `http://localhost:8080`.
4.  Na inicializa√ß√£o, os *Loaders* (`AcaoLoader`, `FundoImobiliarioLoader`, `ProventoLoader`) ir√£o popular o banco H2 com dados de exemplo.

## üìä Acessando o Banco de Dados (H2 Console)

O banco de dados H2 √© em mem√≥ria, o que significa que os dados s√£o recriados a cada inicializa√ß√£o. Voc√™ pode acess√°-lo e visualiz√°-lo atrav√©s do console web:

1.  Acesse: `http://localhost:8080/h2-console`
2.  Use as seguintes configura√ß√µes (definidas em `application.properties`):
    * **JDBC URL:** `jdbc:h2:mem:carteiradb`
    * **User Name:** `sa`
    * **Password:** (deixe em branco)
3.  Clique em "Connect" para ver as tabelas (`ACAO`, `FUNDO_IMOBILIARIO`, `EMPRESA`, `PROVENTO`).

## üó∫Ô∏è Documenta√ß√£o da API (Endpoints)

A API est√° dividida em tr√™s recursos principais. Todos os endpoints tratam erros (400, 404, 500) com respostas JSON padronizadas e s√£o validados.

Abaixo est√° a lista de requisi√ß√µes baseada na cole√ß√£o Postman do projeto.

### A√ß√µes (`/acoes`)

| M√©todo | URL | Descri√ß√£o | Corpo (Body) / Par√¢metros |
| :--- | :--- | :--- | :--- |
| `GET` | `/acoes` | Lista todas as A√ß√µes na carteira. | N/A |
| `GET` | `/acoes/{id}` | Busca uma A√ß√£o pelo seu ID. | N/A |
| `POST`| `/acoes` | Adiciona uma nova A√ß√£o. | `JSON` com a `Acao` (e `Empresa` aninhada). |
| `PUT` | `/acoes/{id}` | Altera uma A√ß√£o existente. | `JSON` com a `Acao` (e `Empresa` aninhada). |
| `DELETE`| `/acoes/{id}` | Exclui uma A√ß√£o pelo seu ID. | N/A |
| `PATCH` | `/acoes/{id}/desdobrar` | Realiza um split (desdobramento) na A√ß√£o. | `?fator=2` (Query Param) |
| `GET` | `/acoes/busca/por-setor` | Busca A√ß√µes pelo setor da empresa. | `?setor=Varejo` (Query Param) |

### Fundos Imobili√°rios (`/fiis`)

| M√©todo | URL | Descri√ß√£o | Corpo (Body) / Par√¢metros |
| :--- | :--- | :--- | :--- |
| `GET` | `/fiis` | Lista todos os FIIs na carteira. | N/A |
| `GET` | `/fiis/{id}` | Busca um FII pelo seu ID. | N/A |
| `POST`| `/fiis` | Adiciona um novo FII. | `JSON` com o `FundoImobili√°rio`. |
| `PUT` | `/fiis/{id}` | Altera um FII existente. | `JSON` com o `FundoImobili√°rio`. |
| `DELETE`| `/fiis/{id}` | Exclui um FII pelo seu ID. | N/A |
| `PATCH` | `/fiis/{id}/atualizar-valor-patrimonial` | Atualiza o valor patrimonial do FII. | `JSON` `{"novoValor": 10.50}` |
| `GET` | `/fiis/busca/por-segmento-e-valor`| Busca FIIs por segmento e valor patrimonial. | `?segmento=Papel&valorMin=10.0` |

### Proventos (`/proventos`)

| M√©todo | URL | Descri√ß√£o | Corpo (Body) / Par√¢metros |
| :--- | :--- | :--- | :--- |
| `GET` | `/acoes/{acaoId}/proventos` | Lista todos os Proventos de uma A√ß√£o. | N/A |
| `POST`| `/acoes/{acaoId}/proventos` | Adiciona um novo Provento a uma A√ß√£o. | `JSON` com o `Provento`. |
| `GET` | `/proventos` | Lista **todos** os Proventos de todas as a√ß√µes. | N/A |
| `GET` | `/proventos/{id}` | Busca um Provento espec√≠fico pelo seu ID. | N/A |
| `PUT` | `/proventos/{id}` | Altera um Provento existente. | `JSON` com o `Provento`. |
| `DELETE`| `/proventos/{id}` | Exclui um Provento pelo seu ID. | N/A |

### Prints do Postman
Visualizacao do H2<br>
![alt text](image.png)


Visualizacao de retornos do postman<br>
![alt text](image-1.png)
![alt text](image-2.png)
![alt text](image-3.png)
![alt text](image-4.png)
![alt text](image-5.png)
![alt text](image-6.png)